<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> -->
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>VisCommentator</title>

    <link rel="stylesheet" href="./styles//style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"
    />
    <link rel="stylesheet" href="styles/tomorrow-night.css" />

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
    <script src="js/highlight.pack.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_CHTML"
      async
    ></script>
  </head>

  <body>
    <div class="teaser">
      <img src="./figs/logo.jpg" />
      <div class="mask"></div>
      <div class="teaser-content">
        <h1>Augmenting Sports Videos with VisCommentator</h1>
        <div class="jump-btn-group">
          <a href="#examples" class="jump-btn">Examples</a>
          <a href="#section2" class="jump-btn">section2</a>
          <a href="#section3" class="jump-btn">section3</a>
          <a href="#section4" class="jump-btn">section4</a>
          <a href="#paper" class="jump-btn">Paper</a>
        </div>
      </div>
    </div>

    <div class="content" style="width: 80vw; max-width: 1024px">
      <section id="abstract" class="abstract">
        <h2>Abstract</h2>
        <p>
          Augmenting sports videos with data visualizations is gaining traction
          given its ability to communicate insights and explicate
          playerstrategies engagingly. However, creating such augmented videos
          is challenging, as it requires considerable domain expertise in
          sportsanalytics and video editing skills. To ease the creation
          process, we present a design space to characterize augmented sports
          videosat element- (<em>what are the constituents</em>) and clip-levels
          (<em>how the constituents are organized</em>) by systematically
          reviewing 233 examplescollected from TV channels, teams, and leagues.
          The design space provides guidance for selecting data insights and
          visualizations forvarious purposes. Informed by the design space, we
          present VisCommentator that facilitates the creation of augmented
          videos fortable tennis with data insights and visualizations
          recommendations. A user study with seven domain experts confirms the
          usefulnessand effectiveness of the system. Another study with sports
          fans found the resulting videos informative and engaging.
        </p>
      </section>

      <hr />

      <section id="examples" class="examples">
        <h2>Examples</h2>
        <!-- <figure
              style="text-align: center; width: 60%; margin: 0 auto 20px auto"
            >
              <img src="figs/41_architecture.png" alt="missing" />
            <figcaption>The complete architecture of our model that can parse both global and local information simultaneously.</figcaption> 
            </figure>-->

        <video src="videos/demo0.mp4" controls></video>
        <div id="examples_demo" class="gallary"></div>
      </section>

      <hr />
      <section id="section1" class="section1">
        <h2>section1</h2>
        <figure
          style="text-align: center; width: 60%; margin: 0 auto 20px auto"
        >
          <img src="figs/logo.jpg" alt="missing" />
          <!-- <figcaption>The complete architecture of our model that can parse both global and local information simultaneously.</figcaption> -->
        </figure>
      </section>
      <hr />

      <section id="section2" class="section1">
        <h2>Corpus</h2>
        <div class="filter-selector-group">
          <select
            class="filter-select"
            id="video_sports"
            onchange="filterCorpus()"
          ></select>
          <select
            class="filter-select"
            id="video_source"
            onchange="filterCorpus()"
          ></select>
          <select
            class="filter-select"
            id="video_source_type"
            onchange="filterCorpus()"
          ></select>
        </div>
        <div id="examples_good" class="gallary"></div>
        <div id="empty_tip">No Video</div>
        <div id="video_pagination" class="pagination"></div>
        <div class="clearfix"></div>
      </section>
      <hr />

      <hr />
      <section id="paper" class="paper">
        <h2>Paper</h2>
        <div class="gallary"></div>
      </section>

      <hr />
      <section id="references" class="references">
        <h2 style="text-align: left">Reference</h2>
      </section>
    </div>

    <script>
              function insertExampleImage() {
                  const section = document.querySelector("#examples > #examples_demo");
                  for (let i = 1; i < 7; ++i) {
                    section.insertAdjacentHTML("beforeend", `
                        <div class="item item-3">
                            <div class="item-content">
                            <a data-fancybox="gallery" href="#demo_${i}">
                                <img src="figs/demo${i}.png" alt='missing' />
                                <i class="fa fa-play-circle"></i>
                            </a>
                            </div>
                        </div>
                        <video
                            width="1280"
                            height="640"
                            controls
                            id="demo_${i}"
                            style="display: none"
                            src="./videos/demo${i}.mp4"
                        ></video>`
                );
              }
            }
            insertExampleImage()

        let currentPage = 0
        let pageNumber = 1
        const pageSize = 12
        let videoNumber = 0
        let videoData = []
        let selectedVideo = []

        function initVideoData() {
            $.getJSON("data/cacheSampled-1.json", function (data) {
                videoData = data
                filterCorpus()
            })
        }
        initVideoData()
   // selector options
   function generateSelector() {
            const sportsOption = ["All Sports", "Badminton", "BasketBall", "Football", "Table Tennis", "Tennis", "American Football", "Volleyball"]
            const sourceOption = ["All Sources", "CCTV", "ShuttleFlash", "陈金", "Boston Celtics", "ClippersCourtvision", "SecondSpectrum", "Tencent", "FIFA", "Vizrt", "ITTF", "Sports analysis", "TennisGate", "ESPN", "NFL"]
            const sourceTypeOption = ["All Source Types", "tv", "team", "fan", "demo", "league", "other organization"]

            // select for video sports
            const sportsSelect = document.querySelector('#video_sports')
            let optionsForSports = ""
            for(let sport of sportsOption) {
                optionsForSports += `<option value="${sport}">${sport}</option>`
            }
            sportsSelect.innerHTML = optionsForSports

            // select for video source
            const sourceSelect = document.querySelector('#video_source')
            let optionsForSource = ""
            for(let source of sourceOption) {
                optionsForSource += `<option value="${source}">${source}</option>`
            }
            sourceSelect.innerHTML = optionsForSource

            // select for video source
            const sourceTypeSelect = document.querySelector('#video_source_type')
            let optionsForSourceType = ""
            for(let sourceType of sourceTypeOption) {
                optionsForSourceType += `<option value="${sourceType}">${sourceType}</option>`
            }
            sourceTypeSelect.innerHTML = optionsForSourceType
        }
        generateSelector()

        // corpus
        function filterCorpus() {
            const selectedSport = document.querySelector('#video_sports').value
            const selectedSource = document.querySelector('#video_source').value
            const selectedSourceType = document.querySelector('#video_source_type').value

            // do the filter
            selectedVideo = []
            videoData.forEach((video, i) => {
                if (selectedSport === "All Sports" || selectedSport === video.sport) {
                    if (selectedSource === "All Sources" || selectedSource === video.source) {
                        if (selectedSourceType === "All Source Types" || selectedSourceType === video.sourceType) {
                            selectedVideo.push(video)
                        }
                    }
                }
            })

            if (selectedVideo.length ===0 ) {
                $("#examples_good").css("display", "none")
                $("#empty_tip").css("display", "block")
            }
            else {
                $("#examples_good").css("display", "")
                $("#empty_tip").css("display", "none")
                const section = document.querySelector('#examples_good')
                section.innerHTML = ""
                videoNumber = selectedVideo.length
                currentPage = 1
                pageNumber = parseInt((videoNumber + pageSize - 1) / pageSize)

                // video list
                for (let i = 0; i < pageSize; i++) {
                    section.insertAdjacentHTML('beforeend', `
                <div class="item">
                    <div class="item-content">
                    <a data-fancybox="gallery" href="http://vegaar.hkustvis.org/videos/${selectedVideo[i].name}">
                    <video src="http://vegaar.hkustvis.org/videos/${selectedVideo[i].name}" alt='missing' />
                     </a>
                    </div>
                </div>
                `)
                }

                // pagination
                const pagination = document.querySelector('#video_pagination')
                let paginationHtml = ""
                paginationHtml += `<button class="pagination-button" onclick="lastPage()" disabled><</button>`
                for (let i = 1; i < pageNumber + 1; i++) {
                    let className = "pagination-button"
                    if (currentPage === i)
                        className += " active"
                    paginationHtml+=`<button class="${className}" onclick="gotoPage(${i})">${i}</button>`
                }
                paginationHtml += `<button id="next_page" class="pagination-button" onclick="nextPage()">></button>`
				pagination.innerHTML = paginationHtml
                if (pageNumber === 1)
                    $("#next_page").attr("disabled", true)
            }
        }

        function lastPage() {
            gotoPage(currentPage-1)
        }

        function nextPage() {
            gotoPage(currentPage + 1)
        }

        function gotoPage(pageIndex) {
            const section = document.querySelector('#examples_good')
            section.innerHTML = ""
            currentPage = pageIndex

            // video list
			let maxNumber
			if (currentPage * pageSize >= videoNumber)
                maxNumber = videoNumber
			else
			    maxNumber = currentPage * pageSize
            for (let i = (currentPage - 1) * pageSize; i < maxNumber; i++) {
                section.insertAdjacentHTML('beforeend', `
                <div class="item">
                    <div class="item-content">
                    <a data-fancybox="gallery" href="http://vegaar.hkustvis.org/videos/${selectedVideo[i].name}">
                    <video src="http://vegaar.hkustvis.org/videos/${selectedVideo[i].name}" alt='missing' />
                     </a>
                    </div>
                </div>
                `)
            }

            // pagination
            const pagination = document.querySelector('#video_pagination')
            let paginationHtml = ""
            paginationHtml += `<button id="last_page" class="pagination-button" onclick="lastPage()"><</button>`
                for (let i = 1; i < pageNumber + 1; i++) {
                    let className = "pagination-button"
                    if (currentPage === i)
                        className += " active"
                    paginationHtml+=`<button class="${className}" onclick="gotoPage(${i})">${i}</button>`
                }
                paginationHtml += `<button id="next_page" class="pagination-button" onclick="nextPage()">></button>`
                pagination.innerHTML = paginationHtml

			if (currentPage === 1)
			    $("#last_page").attr("disabled", true)
            if (currentPage === pageNumber)
                $("#next_page").attr("disabled", true)
        }
    </script>
  </body>
</html>
